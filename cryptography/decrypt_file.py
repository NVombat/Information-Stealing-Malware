from cryptography.fernet import Fernet
from dotenv import load_dotenv
import os

load_dotenv()

key = os.getenv("ENCRYPTION_KEY")
base_path = os.getenv("LINUX_BASE_PATH")

keys_info_e = "e_key_log.txt"
system_info_e = "e_system_info.txt"
clipboard_info_e = "e_clipboard.txt"
chrome_info_e = "e_chrome_info.csv"

keys_info_dc = "dc_key_log.txt"
system_info_dc = "dc_system_info.txt"
clipboard_info_dc = "dc_clipboard.txt"
chrome_info_dc = "dc_chome_info.csv"

key_path = os.path.join(base_path, keys_info_e)
sys_path = os.path.join(base_path, system_info_e)
clip_path = os.path.join(base_path, clipboard_info_e)
chrome_path = os.path.join(base_path, chrome_info_e)

key_dc = os.path.join(base_path, keys_info_dc)
sys_dc = os.path.join(base_path, system_info_dc)
clip_dc = os.path.join(base_path, clipboard_info_dc)
chrome_dc = os.path.join(base_path, chrome_info_dc)

encrypted_files = [key_path, sys_path, clip_path, chrome_path]
decrypted_files = [key_dc, sys_dc, clip_dc, chrome_dc]

try:
    for fe, fd in zip(encrypted_files, decrypted_files):
        with open(fe, "rb") as f1:
            enc_data = f1.read()

        fernet = Fernet(key)
        decrypted = fernet.decrypt(enc_data)

        with open(fd, "wb") as f2:
            f2.write(decrypted)

    f1.close()
    f2.close()
except:
    print("Error Decrypting Files")
